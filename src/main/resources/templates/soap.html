<!DOCTYPE html>
<html lang="hu" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MNB Grafikon</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div th:replace="~{nav :: navbar}"></div>

<div class="main-content">
    <h1>üìà MNB √Årfolyam Lek√©rdez√©s (SOAP)</h1>

    <form action="/soap/lekerdez" method="post">
        <div class="form-group">
            <label for="deviza">Deviza p√°r:</label>
            <select name="deviza" id="deviza">
                <option value="EUR" th:selected="${selectedDeviza == 'EUR'}">EUR (Euro)</option>
                <option value="USD" th:selected="${selectedDeviza == 'USD'}">USD (Amerikai doll√°r)</option>
                <option value="GBP" th:selected="${selectedDeviza == 'GBP'}">GBP (Angol font)</option>
                <option value="CHF" th:selected="${selectedDeviza == 'CHF'}">CHF (Sv√°jci frank)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="startDatum">Kezd≈ë d√°tum:</label>
            <input type="date" name="startDatum" id="startDatum" required th:value="${selectedStart}">
        </div>

        <div class="form-group">
            <label for="endDatum">V√©ge d√°tum:</label>
            <input type="date" name="endDatum" id="endDatum" required th:value="${selectedEnd}">
        </div>

        <button type="submit">Grafikon Rajzol√°sa</button>
    </form>

    <div th:if="${chartLabels != null}" style="margin-top: 40px;">
        <h2>√Årfolyam Grafikon</h2>
        <canvas id="myChart"></canvas>
    </div>
</div>

<script th:inline="javascript" th:if="${chartLabels != null}">
    /*<![CDATA[*/
    const labels = [ [(${chartLabels})] ];
    const dataPoints = [ [(${chartData})] ];

    const ctx = document.getElementById('myChart');

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: '√Årfolyam',
                data: dataPoints,
                borderWidth: 2,
                borderColor: 'rgb(75, 192, 192)',
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                tension: 0.1,
                fill: true
            }]
        },
        options: {
            scales: { y: { beginAtZero: false } }
        }
    });
    /*]]>*/
</script>

</body>
</html>